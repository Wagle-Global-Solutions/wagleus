<!DOCTYPE html>
<html lang="en">

<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1FYJ98BTXG"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-1FYJ98BTXG');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2031642574589224"
    crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="canonical" href="https://wagleus.com/pages/tools/color-picker.html" />
    <title>Color Theory & Code Converter Tool | Free | WUS</title>
    <meta name="description"
        content="Free color theory tool with code conversion, accessibility checker, and color harmonies. Generate color palettes, check WCAG contrast, and convert between HEX, RGB, HSL & CMYK.">
    <meta name="keywords"
        content="color theory tool, color code converter, WCAG contrast checker, color harmony generator, hex to rgb converter, color accessibility, color palette generator, web color tool, color scheme maker, color code translator">
    <meta name="author" content="Wagle Universal Solutions">
    <meta name="robots" content="index, follow">
    <meta name="google-adsense-account" content="ca-pub-2031642574589224">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://wagleus.com/pages/tools/color-picker.html">
    <meta property="og:title" content="Color Theory & Code Converter Tool | Free Online">
    <meta property="og:description"
        content="Color theory tool with code conversion & accessibility checking. Generate palettes, check WCAG contrast, convert color codes for web design.">
    <meta property="og:image" content="/assets/img/logo.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://wagleus.com/pages/tools/color-picker.html">
    <meta property="twitter:title" content="Color Theory & Code Converter Tool">
    <meta property="twitter:description"
        content="Color theory tool with code conversion & accessibility checking. Generate palettes, check WCAG contrast, convert color codes for web design.">
    <meta property="twitter:image" content="/assets/img/logo.png">

    <!-- Enhanced Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Color Theory & Code Converter Tool",
        "applicationCategory": "DesignApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "description": "Free color theory tool with code conversion, accessibility checker, and color harmonies. Generate color palettes and check WCAG contrast ratios.",
        "browserRequirements": "Requires JavaScript",
        "softwareVersion": "1.0",
        "featureList": [
            "Color Theory & Harmonies",
            "Color Code Conversion",
            "WCAG Contrast Checker",
            "Color Palette Generator",
            "Accessibility Tools"
        ],
        "creator": {
            "@type": "Organization",
            "name": "Wagle Universal Solutions",
            "alternateName":["WUS","Wagle","Wagleus"],
            "url": "https://wagleus.com"
        }
    }
    </script>

    <!-- Favicon -->
    <link href="/assets/img/favicon.png" rel="icon">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900&display=swap"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="/assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="/assets/vendor/animate.css/animate.min.css" rel="stylesheet">
    <link href="/assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="/assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <!-- Main CSS File -->
    <link href="/assets/css/main.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">

    <style>
        .color-picker-container {
            padding: 20px;
        }

        .color-preview {
            width: 100%;
            height: 100px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .color-area-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
        }

        #colorArea,
        #hueSlider {
            border: 1px solid #ccc;
            width: 100%;
        }

        #colorArea {
            cursor: crosshair;
        }

        #hueSlider {
            margin-top: 10px;
            cursor: pointer;
            height: 20px;
        }

        .color-picker-marker {
            position: absolute;
            width: 12px;
            height: 12px;
            border: 2px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            box-shadow: 0 0 2px rgba(0, 0, 0, 0.8);
            top: 0;
            left: 0;
        }

        .hue-marker {
            position: absolute;
            width: 4px;
            height: 20px;
            background: white;
            border: 1px solid rgba(0, 0, 0, 0.4);
            transform: translateX(-50%);
            pointer-events: none;
            top: 310px;
            left: 0;
        }

        .color-values input {
            font-family: monospace;
        }

        @media (max-width: 768px) {
            .color-area-container {
                max-width: 100%;
            }

            .value-group {
                margin-bottom: 10px;
            }
        }

        .color-theory-section {
            margin-top: 2rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .color-swatch {
            width: 100%;
            height: 60px;
            border-radius: 6px;
            margin-bottom: 0.5rem;
        }

        .color-info {
            font-size: 0.9rem;
            color: #666;
        }

        .palette-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .palette-color {
            padding: 1rem;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .theory-block {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .theory-description {
            color: #666;
            margin-bottom: 1.5rem;
        }

        .variations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .harmony-display {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .color-item {
            text-align: center;
            padding: 0.5rem;
        }

        .color-preview {
            width: 100%;
            height: 60px;
            border-radius: 6px;
            margin-bottom: 0.5rem;
        }

        .color-hex {
            font-family: monospace;
            font-size: 0.9rem;
            color: #666;
        }

        .contrast-checker {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 6px;
        }

        .contrast-preview {
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            border-radius: 6px;
        }

        .color-strip {
            display: flex;
            gap: 4px;
            margin: 1rem 0;
            height: 40px;
        }
        .color-box {
            flex: 1;
            border-radius: 4px;
            position: relative;
        }
        .color-box::after {
            content: attr(data-value);
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: #666;
            white-space: nowrap;
        }
        .color-example {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin: 1rem 0;
        }
        .color-square {
            width: 100px;
            height: 100px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .color-label {
            font-size: 0.9rem;
            color: #666;
        }

        /* Custom Modal Styles */
        .custom-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .custom-modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            position: relative;
        }

        .modal-close {
            position: absolute;
            right: 15px;
            top: 15px;
            cursor: pointer;
            font-size: 1.5rem;
            color: #666;
        }

        .color-square-container {
            position: relative;
            cursor: pointer;
        }
        
        .color-square {
            position: relative;
        }
        
        .color-copy-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: opacity 0.2s;
            background: transparent;
            border: none;
            padding: 8px;
            cursor: pointer;
            border-radius: 4px;
        }
        
        .color-square-container:hover .color-copy-btn {
            opacity: 1;
        }

        .color-box {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .color-box .color-copy-btn {
            opacity: 0;
            transition: opacity 0.2s;
            position: absolute;
            background: transparent;
            border: none;
            cursor: pointer;
        }

        .color-box:hover .color-copy-btn {
            opacity: 1;
        }

        .color-box-label {
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: #666;
            white-space: nowrap;
        }
    </style>
</head>

<body>
   <!-- Header -->
   <header id="header" class="header fixed-top">
    <div class="container-fluid d-flex align-items-center justify-content-between">
        <a href="/pages/tools/tools.html" class="logo">
            <img src="/assets/img/logo.png" alt="WUS LOGO">
        </a>

        <nav id="navbar" class="navbar">
            <ul>
                <li><a href="/pages/tools/tools.html" class="active">All Tools</a></li>
                <li class="dropdown">
                    <a href="#"><span>Tools Menu</span> <i class="bi bi-chevron-down"></i></a>
                    <ul>
                        <li><a href="/pages/tools/text-manipulation.html">Text Manipulation</a></li>
                        <li><a href="/pages/tools/bulk-image-resizer.html">Bulk Image Resizer</a></li>
                        <li><a href="/pages/tools/json-formatter.html">JSON Formatter</a></li>
                        <li><a href="/pages/tools/password-generator.html">Password Generator</a></li>
                        <li><a href="/pages/tools/number-converter.html">Number Converter</a></li>
                        <li><a href="/pages/tools/base64encoder-decoder.html">Base64 Encoder</a></li>
                        <li><a href="/pages/tools/hash-generator.html">Hash Generator</a></li>
                        <li><a href="/pages/tools/color-picker.html">Color Theory</a></li>
                        <li><a href="/pages/tools/cron-generator.html">Cron Generator</a></li>
                    </ul>
                </li>
                <li><a href="/index.html"><i class="bi bi-house-door"></i> Home</a></li>
            </ul>
            <i class="bi bi-list mobile-nav-toggle"></i>
        </nav>
    </div>
</header>

<!-- Add backdrop div after header -->
<div class="nav-backdrop"></div>

    <main id="main" class="main-content">
        <div class="container my-5">
            <div class="row justify-content-center">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="text-center">Color Picker Tool</h2>
                        </div>
                        <div class="card-body">
                            <div class="color-picker-container">
                                <div class="color-preview mb-4" id="colorPreview"></div>
                                <div class="color-area-container mb-4">
                                    <canvas id="colorArea" width="300" height="300"></canvas>
                                    <canvas id="hueSlider" width="300" height="20"></canvas> <!-- Updated height -->
                                    <div class="color-picker-marker"></div>
                                    <div class="hue-marker"></div>
                                </div>
                                <div class="color-values">
                                    <div class="row">
                                        <div class="col-md-6 mb-2">
                                            <div class="value-group">
                                                <label>HEX:</label>
                                                <div style="position: relative;">
                                                    <input type="text" class="form-control" id="hexValue" onblur="updateFromHex(this.value)" onkeydown="if(event.key === 'Enter') { updateFromHex(this.value); this.blur(); }">
                                                    <button class="copy-icon" onclick="copyValue('hexValue')">
                                                        <i class="bi bi-clipboard"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-2">
                                            <div class="value-group">
                                                <label>RGB:</label>
                                                <div style="position: relative;">
                                                    <input type="text" class="form-control" id="rgbValue" onblur="updateFromRgb(this.value)" onkeydown="if(event.key === 'Enter') { updateFromRgb(this.value); this.blur(); }">
                                                    <button class="copy-icon" onclick="copyValue('rgbValue')">
                                                        <i class="bi bi-clipboard"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-2">
                                            <div class="value-group">
                                                <label>HSL:</label>
                                                <div style="position: relative;">
                                                    <input type="text" class="form-control" id="hslValue" onblur="updateFromHsl(this.value)" onkeydown="if(event.key === 'Enter') { updateFromHsl(this.value); this.blur(); }">
                                                    <button class="copy-icon" onclick="copyValue('hslValue')">
                                                        <i class="bi bi-clipboard"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-2">
                                            <div class="value-group">
                                                <label>HSV:</label>
                                                <div style="position: relative;">
                                                    <input type="text" class="form-control" id="hsvValue" readonly>
                                                    <button class="copy-icon" onclick="copyValue('hsvValue')">
                                                        <i class="bi bi-clipboard"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-2">
                                            <div class="value-group">
                                                <label>CMYK:</label>
                                                <div style="position: relative;">
                                                    <input type="text" class="form-control" id="cmykValue" readonly>
                                                    <button class="copy-icon" onclick="copyValue('cmykValue')">
                                                        <i class="bi bi-clipboard"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <small class="text-muted mt-2 mb-3 d-block text-center">
                                        Press Enter or click outside the input box to apply changes
                                    </small>
                                    <!-- Add Share Button -->
                                    <button class="btn btn-primary w-100 mt-3" onclick="openShareModal()">
                                        <i class="bi bi-share"></i> Share Color
                                    </button>
                                </div>
                            </div>
                            <div class="color-theory-section">
                                <h3 class="mb-4">Color Theory & Combinations</h3>

                                <!-- Color Variations -->
                                <div class="theory-block mb-5">
                                    <h4>Color Variations</h4>
                                    <p class="theory-description">
                                        Tints and shades help create depth and hierarchy in design. Tints are created by adding white, shades by adding black.
                                    </p>
                                    <div class="variations-container">
                                        <h6 class="mb-2">Tints (Adding White)</h6>
                                        <div id="tintStrip" class="color-strip"></div>
                                        <h6 class="mb-2 mt-4">Shades (Adding Black)</h6>
                                        <div id="shadeStrip" class="color-strip"></div>
                                    </div>
                                </div>

                                <!-- Color Harmonies -->
                                <div class="row">
                                    <!-- Complementary -->
                                    <div class="col-md-6 mb-4">
                                        <div class="theory-block">
                                            <h4>Complementary Colors</h4>
                                            <p class="theory-description">Colors opposite on the color wheel. Creates maximum contrast.</p>
                                            <div id="complementaryDisplay" class="color-harmony"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- Split Complementary -->
                                    <div class="col-md-6 mb-4">
                                        <div class="theory-block">
                                            <h4>Split-Complementary</h4>
                                            <p class="theory-description">Uses two colors adjacent to the complement.</p>
                                            <div id="splitComplementaryDisplay" class="color-harmony"></div>
                                        </div>
                                    </div>

                                    <!-- Triadic -->
                                    <div class="col-md-6 mb-4">
                                        <div class="theory-block">
                                            <h4>Triadic Colors</h4>
                                            <p class="theory-description">Three colors equally spaced on the color wheel.</p>
                                            <div id="triadicDisplay" class="color-harmony"></div>
                                        </div>
                                    </div>

                                    <!-- Tetradic -->
                                    <div class="col-md-6 mb-4">
                                        <div class="theory-block">
                                            <h4>Tetradic (Double Complementary)</h4>
                                            <p class="theory-description">Two pairs of complementary colors.</p>
                                            <div id="tetradicDisplay" class="color-harmony"></div>
                                        </div>
                                    </div>

                                    <!-- Analogous -->
                                    <div class="col-md-6 mb-4">
                                        <div class="theory-block">
                                            <h4>Analogous Colors</h4>
                                            <p class="theory-description">Three adjacent colors on the color wheel.</p>
                                            <div id="analogousDisplay" class="color-harmony"></div>
                                        </div>
                                    </div>

                                    <!-- Monochromatic -->
                                    <div class="col-md-6 mb-4">
                                        <div class="theory-block">
                                            <h4>Monochromatic</h4>
                                            <p class="theory-description">Different shades and saturations of the same hue.</p>
                                            <div id="monochromaticDisplay" class="color-harmony"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Contrast Checker -->
                                <div class="theory-block mt-4">
                                    <h4>Contrast Checker</h4>
                                    <p class="theory-description">
                                        Check if your text color has sufficient contrast with the background color for optimal readability. WCAG guidelines recommend a minimum contrast ratio of 4.5:1 for normal text.
                                    </p>
                                    <div class="contrast-checker">
                                        <div class="contrast-preview p-4 mb-3" id="contrastPreview">
                                            <span id="previewText">Preview Text</span>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <label>Text Color: <span id="textColorHex">#000000</span></label>
                                                <input type="color" class="form-control" id="textColorPicker">
                                            </div>
                                            <div class="col-md-6">
                                                <div id="contrastRatio" class="mt-2"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Share Modal -->
        <div class="custom-modal" id="shareModal">
            <div class="modal-content">
                <span class="modal-close" onclick="closeShareModal()">&times;</span>
                <h5 class="modal-title">Share Color</h5>
                <div class="share-preview mb-3 p-3 rounded" id="sharePreview">
                    <div class="color-preview mb-3" id="modalColorPreview" style="height: 100px;"></div>
                    <p id="modalColorValues" class="text-center"></p>
                </div>
                <div class="share-options d-flex flex-wrap gap-2 justify-content-center">
                    <button onclick="shareToFacebook()" class="btn btn-outline-primary">
                        <i class="bi bi-facebook"></i>
                        Facebook
                    </button>
                    <button onclick="shareToTwitter()" class="btn btn-outline-info">
                        <i class="bi bi-twitter-x"></i>
                        Twitter
                    </button>
                    <button onclick="shareToWhatsApp()" class="btn btn-outline-success">
                        <i class="bi bi-whatsapp"></i>
                        WhatsApp
                    </button>
                    <button onclick="shareByEmail()" class="btn btn-outline-secondary">
                        <i class="bi bi-envelope"></i>
                        Email
                    </button>
                </div>
                <div class="mt-4">
                    <label>Direct Link:</label>
                    <div class="input-group">
                        <input type="text" class="form-control" id="shareLink" readonly>
                        <button class="btn btn-outline-primary" onclick="copyShareLink()">
                            <i class="bi bi-clipboard"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>
<!-- Footer -->
<footer id="footer" class="footer dark-background">
    <div class="container text-center">
        <h3 class="sitename">Wagle Universal Solutions</h3>
        <p>Contact us today to learn how we can help you achieve your goals.</p>
        <div class="social-links d-flex justify-content-center">
            <a href="https://www.facebook.com/profile.php?id=61558961715001" target="_blank" class="facebook"><i class="bi bi-facebook"></i></a>
            <a href="https://x.com/wagleus" class="twitter-x" target="_blank" ><i class="bi bi-twitter-x"></i></a>
            <a href="https://www.linkedin.com/company/wagle-universal-solutions/ " target="_blank"class="linkedin"><i class="bi bi-linkedin"></i></a>
          </div>
        <div class="copyright mt-4">
            <span>Copyright</span> <strong class="px-1 sitename">WUS</strong> <span>All Rights Reserved</span>
            <div class="mt-2">
                <a href="../terms-of-service.html" class="text-white">Terms of Service</a>
                <a href="/pages/privacy.html">Privacy Policy</a>
            </div>
        </div>
        <div class="credits">
            Designed by <a>WUS</a>
        </div>
    </div>
    <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

</footer>
<script src="/assets/js/index.js"></script>
    <script>
        let hue, saturation, value;

        // Add URL parameter handling
        function initializeColor() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('h') && urlParams.has('s') && urlParams.has('v')) {
                // Get colors from URL parameters
                hue = parseFloat(urlParams.get('h'));
                saturation = parseFloat(urlParams.get('s'));
                value = parseFloat(urlParams.get('v'));
            } else {
                // Generate random color with good visibility
                hue = Math.floor(Math.random() * 360);
                saturation = Math.floor(Math.random() * 40) + 60; // 60-100 for vibrant colors
                value = Math.floor(Math.random() * 20) + 80; // 80-100 for good visibility
            }

            // Ensure valid values with fallbacks
            hue = isNaN(hue) ? Math.floor(Math.random() * 360) : hue % 360;
            saturation = isNaN(saturation) ? 100 : Math.min(100, Math.max(0, saturation));
            value = isNaN(value) ? 100 : Math.min(100, Math.max(0, value));

            // Update URL immediately
            updateUrlParams();
        }

        // Function to update URL parameters
        function updateUrlParams() {
            const newUrl = new URL(window.location.href);
            newUrl.searchParams.set('h', Math.round(hue));
            newUrl.searchParams.set('s', Math.round(saturation));
            newUrl.searchParams.set('v', Math.round(value));
            window.history.replaceState({}, '', newUrl);
        }

        // Initialize color picker elements
        const colorArea = document.getElementById('colorArea');
        const hueSlider = document.getElementById('hueSlider');
        const colorCtx = colorArea.getContext('2d');
        const hueCtx = hueSlider.getContext('2d');

        // Draw hue slider
        function drawHueSlider() {
            const gradient = hueCtx.createLinearGradient(0, 0, hueSlider.width, 0);
            for (let i = 0; i <= 360; i++) {
                gradient.addColorStop(i / 360, `hsl(${i}, 100%, 50%)`);
            }
            hueCtx.fillStyle = gradient;
            hueCtx.fillRect(0, 0, hueSlider.width, hueSlider.height);
        }

        // Draw color area
        function drawColorArea() {
            // Clear canvas
            colorCtx.clearRect(0, 0, colorArea.width, colorArea.height);

            // Draw saturation gradient (white to pure color)
            const saturationGradient = colorCtx.createLinearGradient(0, 0, colorArea.width, 0);
            saturationGradient.addColorStop(0, 'white');
            saturationGradient.addColorStop(1, `hsl(${hue}, 100%, 50%)`);
            colorCtx.fillStyle = saturationGradient;
            colorCtx.fillRect(0, 0, colorArea.width, colorArea.height);

            // Draw value gradient (transparent black to black)
            const valueGradient = colorCtx.createLinearGradient(0, 0, 0, colorArea.height);
            valueGradient.addColorStop(0, 'transparent');
            valueGradient.addColorStop(1, 'black');
            colorCtx.fillStyle = valueGradient;
            colorCtx.fillRect(0, 0, colorArea.width, colorArea.height);
        }

        // Convert HSV to RGB
        function hsvToRgb(h, s, v) {
            h = h / 360;
            s = s / 100;
            v = v / 100;

            let r, g, b;
            const i = Math.floor(h * 6);
            const f = h * 6 - i;
            const p = v * (1 - s);
            const q = v * (1 - f * s);
            const t = v * (1 - (1 - f) * s);

            switch (i % 6) {
                case 0: r = v; g = t; b = p; break;
                case 1: r = q; g = v; b = p; break;
                case 2: r = p; g = v; b = t; break;
                case 3: r = p; g = q; b = v; break;
                case 4: r = t; g = p; b = v; break;
                case 5: r = v; g = p; b = q; break;
            }

            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }

        // Update color values
        function updateColor() {
            const rgb = hsvToRgb(hue, saturation, value);
            const color = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;

            document.getElementById('colorPreview').style.backgroundColor = color;
            document.getElementById('hexValue').value = rgbToHex(rgb.r, rgb.g, rgb.b);
            document.getElementById('rgbValue').value = color;
            document.getElementById('hslValue').value = rgbToHsl(rgb.r, rgb.g, rgb.b);
            document.getElementById('hsvValue').value = `hsv(${Math.round(hue)}, ${Math.round(saturation)}%, ${Math.round(value)}%)`;
            document.getElementById('cmykValue').value = rgbToCmyk(rgb.r, rgb.g, rgb.b);
            updateMarkers();
            updateColorTheory();
            updateContrastChecker();
            updateUrlParams(); // Add this line at the end of the function
        }

        // Update the markers reference
        const colorMarker = document.querySelector('.color-picker-marker');
        const hueMarker = document.querySelector('.hue-marker');

        // Update marker positions
        function updateMarkers() {
            // Update color area marker
            colorMarker.style.left = `${(saturation / 100) * colorArea.width}px`;
            colorMarker.style.top = `${(1 - value / 100) * colorArea.height}px`;

            // Update hue slider marker - simplified positioning
            hueMarker.style.left = `${(hue / 360) * hueSlider.width}px`;
        }

        // Event Listeners
        hueSlider.addEventListener('mousedown', function (e) {
            const updateHue = function (e) {
                const rect = hueSlider.getBoundingClientRect();
                const x = e.clientX - rect.left;
                hue = (x / hueSlider.width) * 360;
                hue = Math.min(360, Math.max(0, hue));
                drawColorArea();
                updateColor();
                updateMarkers();
            };

            updateHue(e);

            const mouseUpHandler = function () {
                document.removeEventListener('mousemove', updateHue);
                document.removeEventListener('mouseup', mouseUpHandler);
            };

            document.addEventListener('mousemove', updateHue);
            document.addEventListener('mouseup', mouseUpHandler);
        });

        colorArea.addEventListener('mousedown', function (e) {
            const updateSaturationValue = function (e) {
                const rect = colorArea.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                saturation = (x / colorArea.width) * 100;
                value = 100 - (y / colorArea.height) * 100;

                saturation = Math.min(100, Math.max(0, saturation));
                value = Math.min(100, Math.max(0, value));

                updateColor();
                updateMarkers();
            };

            updateSaturationValue(e);

            const mouseUpHandler = function () {
                document.removeEventListener('mousemove', updateSaturationValue);
                document.removeEventListener('mouseup', mouseUpHandler);
            };

            document.addEventListener('mousemove', updateSaturationValue);
            document.addEventListener('mouseup', mouseUpHandler);
        });

        // Add touch support
        function addTouchSupport(element, handler) {
            element.addEventListener('touchstart', function (e) {
                e.preventDefault();
                handler(e.touches[0]);
            });
            element.addEventListener('touchmove', function (e) {
                e.preventDefault();
                handler(e.touches[0]);
            });
        }

        addTouchSupport(hueSlider, function (touch) {
            const rect = hueSlider.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            hue = (x / hueSlider.width) * 360;
            hue = Math.min(360, Math.max(0, hue));
            drawColorArea();
            updateColor();
            updateMarkers();
        });

        addTouchSupport(colorArea, function (touch) {
            const rect = colorArea.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;

            saturation = (x / colorArea.width) * 100;
            value = 100 - (y / colorArea.height) * 100;

            saturation = Math.min(100, Math.max(0, saturation));
            value = Math.min(100, Math.max(0, value));

            updateColor();
            updateMarkers();
        });

        // Keep existing color conversion functions
        function rgbToHex(r, g, b) {
            return '#' + [r, g, b].map(x => {
                const hex = parseInt(x).toString(16);
                return hex.length === 1 ? '0' + hex : hex;
            }).join('');
        }

        function rgbToHsl(r, g, b) {
            r /= 255; g /= 255; b /= 255;
            const max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }

            return `hsl(${Math.round(h * 360)}, ${Math.round(s * 100)}%, ${Math.round(l * 100)}%)`;
        }

        function rgbToCmyk(r, g, b) {
            let c = 1 - (r / 255);
            let m = 1 - (g / 255);
            let y = 1 - (b / 255);
            let k = Math.min(c, Math.min(m, y));

            if (k === 1) {
                c = m = y = 0;
            } else {
                c = (c - k) / (1 - k);
                m = (m - k) / (1 - k);
                y = (y - k) / (1 - k);
            }

            return `cmyk(${Math.round(c * 100)}%, ${Math.round(m * 100)}%, ${Math.round(y * 100)}%, ${Math.round(k * 100)}%)`;
        }

        // Add copy functionality
        function copyValue(elementId) {
            const input = document.getElementById(elementId);
            input.select();
            document.execCommand('copy');

            // Visual feedback
            const btn = event.currentTarget;
            const icon = btn.querySelector('i');
            icon.classList.remove('bi-clipboard');
            icon.classList.add('bi-clipboard-check');

            setTimeout(() => {
                icon.classList.remove('bi-clipboard-check');
                icon.classList.add('bi-clipboard');
            }, 1500);
        }

        // Fix the hue slider width issue by setting canvas width in JS
        function resizeHueSlider() {
            const width = colorArea.offsetWidth;
            hueSlider.width = width;
            colorArea.width = width;
            drawHueSlider();
            drawColorArea();
            updateColor();
        }

        // Add resize handler
        window.addEventListener('resize', resizeHueSlider);

        // Add modal initialization after DOM content is loaded
        window.addEventListener('DOMContentLoaded', () => {
            initializeColor();
            resizeHueSlider();
            drawHueSlider();
            drawColorArea();
            updateColor();
            // Initialize all modals
            if (typeof bootstrap !== 'undefined') {
                var shareModal = new bootstrap.Modal(document.getElementById('shareModal'));
            }
        });

        document.getElementById('shareModal').addEventListener('show.bs.modal', function (event) {
            const currentColor = document.getElementById('hexValue').value;
            const currentRgb = document.getElementById('rgbValue').value;
            
            // Update modal preview
            document.getElementById('modalColorPreview').style.backgroundColor = currentColor;
            document.getElementById('modalColorValues').textContent = `${currentColor} â€¢ ${currentRgb}`;
            
            // Generate share link
            const shareUrl = new URL(window.location.href);
            document.getElementById('shareLink').value = shareUrl.toString();
        });

        function getColorRelationships(h, s, v) {
            return {
                complementary: [(h + 180) % 360, s, v],
                analogous1: [(h + 30) % 360, s, v],
                analogous2: [(h - 30 + 360) % 360, s, v],
                triadic1: [(h + 120) % 360, s, v],
                triadic2: [(h + 240) % 360, s, v],
                split1: [(h + 150) % 360, s, v],
                split2: [(h + 210) % 360, s, v],
                tetradic1: [(h + 90) % 360, s, v],
                tetradic2: [(h + 180) % 360, s, v],
                tetradic3: [(h + 270) % 360, s, v]
            };
        }

        function generateColorPalettes(h, s, v) {
            return {
                monochromatic: [
                    [h, s, v],                    // Original color
                    [h, s * 0.8, v],              // Less saturated
                    [h, s * 0.6, v],              // Even less saturated
                    [h, s, v * 0.8],              // Darker
                    [h, s, v * 0.6]               // Even darker
                ]
            };
        }

        function updateColorTheory() {
            // Update base color and variations
            const baseRgb = hsvToRgb(hue, saturation, value);
            const baseHex = rgbToHex(baseRgb.r, baseRgb.g, baseRgb.b);

            // Update color harmonies
            updateComplementary(baseHex);
            updateSplitComplementary();
            updateTriadic();
            updateTetradic();
            updateAnalogous();
            updateMonochromatic();
            updateTintsAndShades();
        }

        function updateComplementary(baseHex) {
            const compHue = (hue + 180) % 360;
            const compRgb = hsvToRgb(compHue, saturation, value);
            const compHex = rgbToHex(compRgb.r, compRgb.g, compRgb.b);

            document.getElementById('complementaryDisplay').innerHTML = generateColorSquares([
                { color: baseHex, label: 'Base' },
                { color: compHex, label: 'Complement' }
            ]);
        }

        function updateSplitComplementary() {
            const split1 = (hue + 150) % 360;
            const split2 = (hue + 210) % 360;

            document.getElementById('splitComplementaryDisplay').innerHTML = generateColorSquares([
                { color: rgbToHex(...Object.values(hsvToRgb(hue, saturation, value))), label: 'Base' },
                { color: rgbToHex(...Object.values(hsvToRgb(split1, saturation, value))), label: 'Split 1' },
                { color: rgbToHex(...Object.values(hsvToRgb(split2, saturation, value))), label: 'Split 2' }
            ]);
        }

        function updateTriadic() {
            const triad1 = (hue + 120) % 360;
            const triad2 = (hue + 240) % 360;

            document.getElementById('triadicDisplay').innerHTML = generateColorSquares([
                { color: rgbToHex(...Object.values(hsvToRgb(hue, saturation, value))), label: 'Base' },
                { color: rgbToHex(...Object.values(hsvToRgb(triad1, saturation, value))), label: 'Triad 1' },
                { color: rgbToHex(...Object.values(hsvToRgb(triad2, saturation, value))), label: 'Triad 2' }
            ]);
        }

        function updateTetradic() {
            const tetra1 = (hue + 90) % 360;
            const tetra2 = (hue + 180) % 360;
            const tetra3 = (hue + 270) % 360;

            document.getElementById('tetradicDisplay').innerHTML = generateColorSquares([
                { color: rgbToHex(...Object.values(hsvToRgb(hue, saturation, value))), label: 'Base' },
                { color: rgbToHex(...Object.values(hsvToRgb(tetra1, saturation, value))), label: 'Tetra 1' },
                { color: rgbToHex(...Object.values(hsvToRgb(tetra2, saturation, value))), label: 'Tetra 2' },
                { color: rgbToHex(...Object.values(hsvToRgb(tetra3, saturation, value))), label: 'Tetra 3' }
            ]);
        }

        function updateAnalogous() {
            const analogous1 = (hue + 30) % 360;
            const analogous2 = (hue - 30 + 360) % 360;

            document.getElementById('analogousDisplay').innerHTML = generateColorSquares([
                { color: rgbToHex(...Object.values(hsvToRgb(hue, saturation, value))), label: 'Base' },
                { color: rgbToHex(...Object.values(hsvToRgb(analogous1, saturation, value))), label: 'Analogous 1' },
                { color: rgbToHex(...Object.values(hsvToRgb(analogous2, saturation, value))), label: 'Analogous 2' }
            ]);
        }

        function updateMonochromatic() {
            const monochromaticColors = [];
            
            // Generate base color
            monochromaticColors.push({
                color: rgbToHex(...Object.values(hsvToRgb(hue, saturation, value))),
                label: 'Base'
            });

            // Generate variations
            monochromaticColors.push({
                color: rgbToHex(...Object.values(hsvToRgb(hue, saturation * 0.8, value))),
                label: 'Variation 1'
            });
            monochromaticColors.push({
                color: rgbToHex(...Object.values(hsvToRgb(hue, saturation * 0.6, value))),
                label: 'Variation 2'
            });
            monochromaticColors.push({
                color: rgbToHex(...Object.values(hsvToRgb(hue, saturation, value * 0.8))),
                label: 'Variation 3'
            });
            monochromaticColors.push({
                color: rgbToHex(...Object.values(hsvToRgb(hue, saturation, value * 0.6))),
                label: 'Variation 4'
            });

            document.getElementById('monochromaticDisplay').innerHTML = generateColorSquares(monochromaticColors);
        }

        function updateTintsAndShades() {
            const tintStrip = document.getElementById('tintStrip');
            const shadeStrip = document.getElementById('shadeStrip');

            // Generate tints
            let tintsHTML = '';
            for(let i = 0; i <= 10; i++) {
                const tintHsv = [hue, saturation, value + ((100 - value) * (i/10))];
                const rgb = hsvToRgb(...tintHsv);
                const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
                const textColor = getBestContrastColor(hex);
                
                tintsHTML += `
                    <div class="color-box" style="background-color: ${hex}">
                        <button class="color-copy-btn" 
                                onclick="copyHexColor('${hex}')" 
                                style="color: ${textColor}"
                                title="Copy ${hex}">
                            <i class="bi bi-clipboard"></i>
                        </button>
                        <span class="color-box-label">${hex}</span>
                    </div>
                `;
            }
            tintStrip.innerHTML = tintsHTML;

            // Generate shades
            let shadesHTML = '';
            for(let i = 0; i <= 10; i++) {
                const shadeHsv = [hue, saturation, value * (1 - i/10)];
                const rgb = hsvToRgb(...shadeHsv);
                const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
                const textColor = getBestContrastColor(hex);
                
                shadesHTML += `
                    <div class="color-box" style="background-color: ${hex}">
                        <button class="color-copy-btn" 
                                onclick="copyHexColor('${hex}')" 
                                style="color: ${textColor}"
                                title="Copy ${hex}">
                            <i class="bi bi-clipboard"></i>
                        </button>
                        <span class="color-box-label">${hex}</span>
                    </div>
                `;
            }
            shadeStrip.innerHTML = shadesHTML;
        }

        function generateColorSquares(colors) {
            return colors.map(({color, label}) => {
                // Calculate best contrast color for icon
                const textColor = getBestContrastColor(color);
                
                return `
                    <div class="color-square-container">
                        <div class="color-square" style="background-color: ${color}">
                            <button class="color-copy-btn" 
                                    onclick="copyHexColor('${color}')" 
                                    style="color: ${textColor}"
                                    title="Copy ${color}">
                                <i class="bi bi-clipboard"></i>
                            </button>
                        </div>
                        <div class="color-label">${label}<br>${color}</div>
                    </div>
                `;
            }).join('');
        }
        
        // Add these new helper functions
        function getBestContrastColor(bgColor) {
            // Remove # if present
            const color = bgColor.charAt(0) === '#' ? bgColor.substring(1) : bgColor;
            
            // Convert hex to RGB
            const r = parseInt(color.substr(0,2), 16);
            const g = parseInt(color.substr(2,2), 16);
            const b = parseInt(color.substr(4,2), 16);
            
            // Calculate perceived brightness
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            
            // Choose white or black based on brightness
            const textColor = brightness > 128 ? '#000000' : '#FFFFFF';
            
            // Verify contrast ratio meets WCAG AA
            const ratio = calculateContrastRatio(textColor, bgColor);
            
            // Return the color with better contrast
            return ratio >= 4.5 ? textColor : (brightness > 128 ? '#000000' : '#FFFFFF');
        }
        
        function copyHexColor(color) {
            // Create temporary input element
            const temp = document.createElement('input');
            temp.value = color;
            document.body.appendChild(temp);
            
            // Select and copy
            temp.select();
            document.execCommand('copy');
            document.body.removeChild(temp);
            
            // Show feedback
            const btn = event.currentTarget;
            const icon = btn.querySelector('i');
            icon.classList.remove('bi-clipboard');
            icon.classList.add('bi-clipboard-check');
            
            setTimeout(() => {
                icon.classList.remove('bi-clipboard-check');
                icon.classList.add('bi-clipboard');
            }, 1500);
        }

        function getColorAnalysis(h, s, v) {
            const colorCategory = getColorCategory(h);
            const colorProperties = getColorProperties(s, v);

            return `
            <div class="color-info">
                <p><strong>Color Category:</strong> ${colorCategory}</p>
                <p><strong>Properties:</strong> ${colorProperties}</p>
                <p><strong>Usage Suggestions:</strong></p>
                <ul>
                    ${getColorUsageSuggestions(colorCategory)}
                </ul>
            </div>
        `;
        }

        function getColorCategory(h) {
            const categories = [
                [0, 'Red'], [30, 'Orange'], [60, 'Yellow'],
                [120, 'Green'], [180, 'Cyan'], [240, 'Blue'],
                [300, 'Purple'], [330, 'Pink'], [360, 'Red']
            ];

            for (let i = 0; i < categories.length - 1; i++) {
                if (h >= categories[i][0] && h < categories[i + 1][0]) {
                    return categories[i][1];
                }
            }

            return 'Red';
        }

        function getColorProperties(s, v) {
            const properties = [];

            if (s < 30) properties.push('Desaturated');
            else if (s > 70) properties.push('Vibrant');

            if (v < 30) properties.push('Dark');
            else if (v > 70) properties.push('Bright');
            else properties.push('Medium');

            return properties.join(', ');
        }

        function getColorUsageSuggestions(category) {
            const suggestions = {
                Red: ['Creates urgency', 'Good for calls-to-action', 'Stimulates appetite'],
                Blue: ['Promotes trust', 'Good for corporate designs', 'Creates calm'],
                Green: ['Represents growth', 'Environmental themes', 'Natural balance'],
                Yellow: ['Optimistic', 'Good for warnings', 'Creates energy'],
                Purple: ['Luxury', 'Creative contexts', 'Spiritual themes'],
                Orange: ['Friendly', 'Confidence', 'Adventure'],
                Pink: ['Feminine', 'Youth', 'Romance'],
                Cyan: ['Professional', 'Clean', 'Modern'],
            };

            return (suggestions[category] || []).map(s => `<li>${s}</li>`).join('');
        }

        function generateVariations(h, s, v) {
            const variations = [];

            // Generate tints (adding white)
            for(let i = 9; i >= 1; i--) {
                variations.push([h, s, v + ((100 - v) * (i/10))]);
            }

            variations.push([h, s, v]); // Original color

            // Generate shades (adding black)
            for(let i = 1; i <= 9; i++) {
                variations.push([h, s, v * (1 - i/10)]);
            }

            return variations;
        }

        function updateContrastChecker() {
            const bgColor = document.getElementById('colorPreview').style.backgroundColor;
            const preview = document.getElementById('contrastPreview');
            
            // Convert background color to RGB
            const bgRGB = bgColor.match(/\d+/g).map(Number);
            
            // Calculate perceived brightness of background
            const brightness = (bgRGB[0] * 299 + bgRGB[1] * 587 + bgRGB[2] * 114) / 1000;
            
            // Start with black or white based on background brightness
            let textColor = brightness > 128 ? '#000000' : '#FFFFFF';
            
            // Calculate initial contrast ratio
            let ratio = calculateContrastRatio(textColor, bgColor);
            
            // If the contrast ratio doesn't meet WCAG AA standard (4.5:1),
            // adjust the text color to ensure compliance
            if (ratio < 4.5) {
                // Try the opposite color
                textColor = textColor === '#000000' ? '#FFFFFF' : '#000000';
                ratio = calculateContrastRatio(textColor, bgColor);
                
                // If still not compliant, use enhanced versions
                if (ratio < 4.5) {
                    // Try dark gray or light gray depending on background
                    textColor = brightness > 128 ? '#000000' : '#FFFFFF';
                }
            }
            
            // Update color picker and hex display
            document.getElementById('textColorPicker').value = textColor;
            document.getElementById('textColorHex').textContent = textColor;
            
            // Apply colors
            preview.style.backgroundColor = bgColor;
            preview.style.color = textColor;
            
            // Update ratio display
            document.getElementById('contrastRatio').innerHTML = `
                <strong>Contrast Ratio: ${ratio.toFixed(2)}:1</strong><br>
                <span class="text-success">Meets WCAG AA standards</span>
            `;
        }

        document.getElementById('textColorPicker').addEventListener('input', function(e) {
            const textColor = e.target.value;
            const preview = document.getElementById('contrastPreview');
            const bgColor = preview.style.backgroundColor;
            
            // Update hex display
            document.getElementById('textColorHex').textContent = textColor;
            
            // Update preview
            preview.style.color = textColor;
            
            // Update contrast ratio
            const ratio = calculateContrastRatio(textColor, bgColor);
            document.getElementById('contrastRatio').innerHTML = `
                <strong>Contrast Ratio: ${ratio.toFixed(2)}:1</strong><br>
                <span class="${ratio >= 4.5 ? 'text-success' : 'text-danger'}">
                    ${ratio >= 4.5 ? 'Meets' : 'Does not meet'} WCAG AA standards
                </span>
            `;
        });

        function calculateContrastRatio(color1, color2) {
            // Parse colors to RGB
            const getRGB = (color) => {
                // Handle hex color
                if (color.startsWith('#')) {
                    const r = parseInt(color.slice(1, 3), 16);
                    const g = parseInt(color.slice(3, 5), 16);
                    const b = parseInt(color.slice(5, 7), 16);
                    return [r, g, b];
                }

                // Handle rgb/rgba color
                const match = color.match(/\d+/g);
                return [parseInt(match[0]), parseInt(match[1]), parseInt(match[2])];
            };

            // Calculate relative luminance
            const getLuminance = (r, g, b) => {
                const [rs, gs, bs] = [r, g, b].map(c => {
                    c = c / 255;
                    return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
                });
                return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
            };

            // Get RGB values for both colors
            const [r1, g1, b1] = getRGB(color1);
            const [r2, g2, b2] = getRGB(color2);

            // Calculate luminance
            const l1 = getLuminance(r1, g1, b1);
            const l2 = getLuminance(r2, g2, b2);

            // Calculate contrast ratio
            const lighter = Math.max(l1, l2);
            const darker = Math.min(l1, l2);
            return (lighter + 0.05) / (darker + 0.05);
        }

        // Add these functions after your existing JavaScript code
        function openShareModal() {
            const modal = document.getElementById('shareModal');
            const currentColor = document.getElementById('hexValue').value;
            const currentRgb = document.getElementById('rgbValue').value;
            
            // Update modal preview
            document.getElementById('modalColorPreview').style.backgroundColor = currentColor;
            document.getElementById('modalColorValues').textContent = `${currentColor} â€¢ ${currentRgb}`;
            
            // Generate share link with relative path
            const path = '/pages/tools/color-picker.html';
            const queryParams = `?h=${Math.round(hue)}&s=${Math.round(saturation)}&v=${Math.round(value)}`;
            const shareUrl = window.location.protocol + '//' + window.location.host + path + queryParams;
            
            document.getElementById('shareLink').value = shareUrl;
            
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeShareModal() {
            const modal = document.getElementById('shareModal');
            modal.classList.remove('show');
            document.body.style.overflow = ''; // Restore scrolling
        }

        // Close modal when clicking outside
        document.getElementById('shareModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeShareModal();
            }
        });

        // Optional: Close on Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && document.getElementById('shareModal').classList.contains('show')) {
                closeShareModal();
            }
        });

        function copyShareLink() {
            const shareLink = document.getElementById('shareLink');
            shareLink.select();
            document.execCommand('copy');

            // Visual feedback
            const button = event.currentTarget;
            const icon = button.querySelector('i');
            icon.classList.remove('bi-clipboard');
            icon.classList.add('bi-clipboard-check');

            setTimeout(() => {
                icon.classList.remove('bi-clipboard-check');
                icon.classList.add('bi-clipboard');
            }, 1500);
        }

        function shareToFacebook() {
            const text = encodeURIComponent(`Check out this color I found!`);
            const url = encodeURIComponent(document.getElementById('shareLink').value);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`, '_blank');
        }

        function shareToTwitter() {
            const text = encodeURIComponent(`Check out this color I found! ${document.getElementById('hexValue').value}`);
            const url = encodeURIComponent(document.getElementById('shareLink').value);
            window.open(`https://twitter.com/intent/tweet?url=${url}&text=${text}`, '_blank');
        }

        function shareToWhatsApp() {
            const text = encodeURIComponent(`Check out this color I found! ${document.getElementById('hexValue').value}\n`);
            const url = document.getElementById('shareLink').value;
            window.open(`https://wa.me/?text=${text}${url}`, '_blank');
        }

        function shareByEmail() {
            const subject = encodeURIComponent('Check out this color!');
            const body = encodeURIComponent(`I found this amazing color: ${document.getElementById('hexValue').value}\n\nCheck it out here: ${document.getElementById('shareLink').value}`);
            window.location.href = `mailto:?subject=${subject}&body=${body}`;
        }

        function updateFromHex(hexValue) {
            // Visual feedback
            const input = document.getElementById('hexValue');
            const originalBg = input.style.backgroundColor;
            
            // Clean and validate hex
            hexValue = hexValue.trim().replace(/^#/, '');
            if (!/^[0-9A-Fa-f]{6}$/.test(hexValue)) {
                // Invalid input feedback
                input.style.backgroundColor = '#ffe6e6';
                setTimeout(() => {
                    input.style.backgroundColor = originalBg;
                    updateColor(); // Reset to current value
                }, 500);
                return;
            }
            
            // Success feedback
            input.style.backgroundColor = '#e6ffe6';
            setTimeout(() => {
                input.style.backgroundColor = originalBg;
            }, 500);
            
            // Convert hex to RGB
            const r = parseInt(hexValue.substring(0, 2), 16);
            const g = parseInt(hexValue.substring(2, 4), 16);
            const b = parseInt(hexValue.substring(4, 6), 16);
            
            // Convert RGB to HSV and update
            const hsv = rgbToHsv(r, g, b);
            hue = hsv.h;
            saturation = hsv.s;
            value = hsv.v;
            
            drawColorArea();
            updateColor();
            updateMarkers();
        }

        function updateFromRgb(rgbValue) {
            const input = document.getElementById('rgbValue');
            const originalBg = input.style.backgroundColor;
            
            // Parse RGB values
            const match = rgbValue.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
            if (!match) {
                input.style.backgroundColor = '#ffe6e6';
                setTimeout(() => {
                    input.style.backgroundColor = originalBg;
                    updateColor();
                }, 500);
                return;
            }
            
            const r = parseInt(match[1]);
            const g = parseInt(match[2]);
            const b = parseInt(match[3]);
            
            if (r > 255 || g > 255 || b > 255) {
                input.style.backgroundColor = '#ffe6e6';
                setTimeout(() => {
                    input.style.backgroundColor = originalBg;
                    updateColor();
                }, 500);
                return;
            }
            
            input.style.backgroundColor = '#e6ffe6';
            setTimeout(() => {
                input.style.backgroundColor = originalBg;
            }, 500);
            
            // Convert RGB to HSV and update
            const hsv = rgbToHsv(r, g, b);
            hue = hsv.h;
            saturation = hsv.s;
            value = hsv.v;
            
            drawColorArea();
            updateColor();
            updateMarkers();
        }

        function updateFromHsl(hslValue) {
            const input = document.getElementById('hslValue');
            const originalBg = input.style.backgroundColor;
            
            // Parse HSL values
            const match = hslValue.match(/^hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)$/);
            if (!match) {
                input.style.backgroundColor = '#ffe6e6';
                setTimeout(() => {
                    input.style.backgroundColor = originalBg;
                    updateColor();
                }, 500);
                return;
            }
            
            const h = parseInt(match[1]);
            const s = parseInt(match[2]);
            const l = parseInt(match[3]);
            
            if (h > 360 || s > 100 || l > 100) {
                input.style.backgroundColor = '#ffe6e6';
                setTimeout(() => {
                    input.style.backgroundColor = originalBg;
                    updateColor();
                }, 500);
                return;
            }
            
            input.style.backgroundColor = '#e6ffe6';
            setTimeout(() => {
                input.style.backgroundColor = originalBg;
            }, 500);
            
            // Convert HSL to RGB
            const rgb = hslToRgb(h, s, l);
            
            // Convert RGB to HSV and update
            const hsv = rgbToHsv(rgb.r, rgb.g, rgb.b);
            hue = hsv.h;
            saturation = hsv.s;
            value = hsv.v;
            
            drawColorArea();
            updateColor();
            updateMarkers();
        }

        function rgbToHsv(r, g, b) {
            r /= 255;
            g /= 255;
            b /= 255;
            
            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            const d = max - min;
            
            let h;
            const s = max === 0 ? 0 : d / max;
            const v = max;
            
            if (max === min) {
                h = 0;
            } else {
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h *= 60;
            }
            
            return { h, s: s * 100, v: v * 100 };
        }

        function hslToRgb(h, s, l) {
            h /= 360;
            s /= 100;
            l /= 100;
            
            let r, g, b;
            
            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };
                
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                
                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }
            
            return {
                r: Math.round(r * 255),
                g: Math.round(g * 255),
                b: Math.round(b * 255)
            };
        }
    </script>
</body>
</html>